import boto3
from botocore.client import Config

# Replace with your EMC S3 credentials and endpoint
access_key = 'your_access_key'
secret_key = 'your_secret_key'
endpoint_url = 'https://your_emc_s3_endpoint'

# Create a session and S3 client with custom endpoint
session = boto3.session.Session()
s3_client = session.client(
    's3',
    aws_access_key_id=access_key,
    aws_secret_access_key=secret_key,
    endpoint_url=endpoint_url,
    config=Config(signature_version='s3v4')  # Ensure compatibility with S3 API
)

# Specify the bucket name
bucket_name = 'your_bucket_name'

# List objects in the bucket
response = s3_client.list_objects_v2(Bucket=bucket_name)

# Print the list of objects
if 'Contents' in response:
    for obj in response['Contents']:
        print(obj['Key'])
else:
    print('No objects found in the bucket.')
