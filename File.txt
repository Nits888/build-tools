import pandas as pd
import json

# Load the Excel file
file_path = 'C:\\Users\\Nitin\\OneDrive\\Documents\\pivotdata.xlsx'  # Update with your file path
sheet_name = 'Sheet1'  # Update with your sheet name if necessary

# Read the Excel file
df = pd.read_excel(file_path, sheet_name=sheet_name)

# Create a dictionary to hold the data
data_dict = {}
for i, row in df.iterrows():
    asset_class = row['Asset Class']
    sub_asset_class = row['Sub Asset Class']
    owner = row['Owner']
    applications = row['Application']

    if asset_class not in data_dict:
        data_dict[asset_class] = {}

    if sub_asset_class not in data_dict[asset_class]:
        data_dict[asset_class][sub_asset_class] = []

    data_dict[asset_class][sub_asset_class].append({"Owner": owner, "Applications": applications})

# Convert the dictionary to a JSON string
json_data = json.dumps(data_dict, indent=4)

# Print the JSON data
print(json_data)

# Optionally, save the JSON data to a file
output_file = 'output.json'  # Update with your desired output file path
with open(output_file, 'w') as f:
    f.write(json_data)
