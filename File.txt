#!/bin/bash

# Path to the JSON configuration file
CONFIG_FILE="config.json"

# Function to get values from the JSON file
call_function() {
    local category=$1
    local key=$2

    # Using awk to parse the JSON-like structure
    awk -v cat="$category" -v k="$key" '
    BEGIN { foundCat = 0; }
    {
        # Remove spaces and quotes for easier matching
        gsub(/ /, "")
        gsub(/"/, "")

        # Match category
        if ($0 ~ cat ":\\{") {
            foundCat = 1
        }

        # If category is found and we match the key, print the value
        if (foundCat && $1 == k ":") {
            # Remove trailing comma and print the value
            gsub(/,/, "", $2)
            print $2
            exit
        }

        # If we find another category, stop looking
        if (foundCat && $0 ~ "\\}") {
            foundCat = 0
        }
    }
    ' "$CONFIG_FILE"
}

# Example usage:
# call_function hosts Dev
# call_function Ports Node
# call_function fqdn Dev

# To test the function, uncomment the lines below:
# echo $(call_function hosts Dev)
# echo $(call_function Ports Node)
# echo $(call_function fqdn Dev)
